<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="HN, ">

        <link rel="alternate"  href="https://haridas.in/feeds/all.atom.xml" type="application/atom+xml" title="HN Full Atom Feed"/>

    <title>Bind With Promise // all posts // HN </title>


    <!-- Google Fonts -->

    <!--
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,300italic,300|Roboto:400,300,300italic,400italic,700,500|Open+Sans:400,400italic,600|Source+Sans+Pro:400,300italic,300,400italic,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=PT+Mono|Inconsolata|Source+Code+Pro:400,300,500|Ubuntu+Mono:400,400italic,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=PT+Serif|PT+Sans|Libre+Baskerville|Droid+Serif' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lora|Slabo+27px' rel='stylesheet' type='text/css'>
    -->

    <link href='https://fonts.googleapis.com/css?family=PT+Mono|PT+Serif|PT+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://haridas.in/theme/css/pure.css">
    <link rel="stylesheet" href="https://haridas.in/theme/css/asciidoctor.css">

    <link rel="stylesheet" href="https://haridas.in/theme/css/pygments.css">

    <!--
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    -->

    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="container">

            <div class="container-header">
            </div>


            <div class="container-body">

                    <div class="body-sidebar">
                        <header class="content-sidebar">

                            <hgroup>

                                <img class="avatar" src="https://haridas.in/images/profile_pic.jpg">

                                <h1 class="brand-main"><a href="https://haridas.in">HN</a></h1>


                                        <p class="links">
                                            <a href="https://haridas.in/pages/about-me.html">About
                                            </a>
                                        </p>
                                <p class="social">
                                        <a href="http://twitter.com/haridas_n">
                                                <img src="https://haridas.in/images/tt.svg" alt="menu icon" width="48" height="48" />
                                        </a>
                                        <a href="http://github.com/haridas">
                                                <img src="https://haridas.in/images/github.svg" alt="menu icon" width="45" height="45" />
                                        </a>
                                        <a href="http://in.linkedin.com/pub/haridas-n/19/95/825">
                                                <img src="https://haridas.in/images/linkedin.svg" alt="menu icon" width="48" height="48" />
                                        </a>
                                </p>
                            </hgroup>
                    </header>

                    </div>


                    <div class="body-column">
    <div class="content">
        <div class="column">
            <section class="post">
                <header class="post-header">
                    <h1 class="article-title">Bind With Promise</h1>
                        <p class="post-meta">
                            Tags:                                 <a class="post-category" href="https://haridas.in/tag/nodejs.html">nodejs</a>
                                <a class="post-category" href="https://haridas.in/tag/promise.html">promise</a>
                                <a class="post-category" href="https://haridas.in/tag/bind.html">bind</a>
                        </p>


<a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="haridas_n">
    Tweet
</a>

<script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script>

<!-- Place this tag where you want the +1 button to render. -->
<div class="g-plusone" data-size="medium"></div>

<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
       var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
           po.src = 'https://apis.google.com/js/platform.js';
               var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
                 })();
</script>                        <p class="post-date">
                            in <a href="https://haridas.in/category/blog.html">blog</a> &middot; Thu 21 December 2017
                        </p>
                </header>
            </section>
            <p><cite>bind</cite> function in js is an interesting function that does behave like a wrapper function,
which make the function bound with wrapper function. This wrapper function helps to
do call the target function with in custom contexts with arguments.
Bind act similar to the decorators in python, as in decorator also there is wrapper
function which intercept the target function. But here the <cite>bind</cite> is kinda black box
we  can't get custom behavior from it, nevertheless the standard nature of what
bind provide is what needed in the <cite>javascript</cite> async execution environment.</p>
<p>Javascript is known to be called as Lisp like functional behavior exposed via C like
syntax. The functions in js can run in any context, that context decides the <cite>this</cite>
argument, here the <cite>bind</cite> give the power to dynamically change the execution
context of a function.</p>
<p>I came across with bind more when working with the promise, where we chain the
operations using multiple functions.</p>
<p>Let me show the use of bind with an example.</p>
<p><cite>request_handler.js</cite></p>
<div class="highlight"><pre><span></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Authenticator</span> <span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">config</span> <span class="o">=</span> <span class="nx">config</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">authenticate</span><span class="p">(</span><span class="nx">header</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Does some logic based on the authentication.</span>
        <span class="c1">// throw Exception if auth fails.</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">HandleRequest</span> <span class="p">{</span>
    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nx">handle</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">header</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;this object: &#39;</span> <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="s2">&quot; result: &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">resolve</span><span class="p">({</span><span class="s1">&#39;body&#39;</span><span class="o">:</span> <span class="s1">&#39;hello world&#39;</span><span class="p">,</span> <span class="s1">&#39;content-type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">});</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">var</span> <span class="nx">auth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Authenticator</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="o">:</span> <span class="s1">&#39;basic&#39;</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">handler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HandleRequest</span><span class="p">();</span>

<span class="c1">//console.log(auth, handler);</span>

<span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="s1">&#39;Basic dweDasdfesdDDa==&#39;</span><span class="p">}</span>

<span class="nx">auth</span><span class="p">.</span><span class="nx">authenticate</span><span class="p">(</span><span class="nx">headers</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">handle</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">headers</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;request successful..&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">200</span><span class="p">;</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Some exception in the chain. Return 500 status.</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;request failed..&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">500</span><span class="p">;</span>
    <span class="p">});</span>
</pre></div>
<p>Just execute the code and see the result.</p>
<div class="highlight"><pre><span></span>$ node request_handler.js
this object: <span class="o">[</span>object Object<span class="o">]</span> result: <span class="nb">true</span>
request successful..
</pre></div>
<p>The example shows simple http request handling with authentication. We chained
the request process using promise for easiness. If you noticed here the request
handlers are all return standard promise objects, the final orchestration code
will chain it together with error handling.</p>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">handle</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">headers</span><span class="p">))</span>
</pre></div>
<dl class="docutils">
<dt>Bind function pass the arguments to target function in order they are bound to it.</dt>
<dd><cite>.bind</cite> func syntax,</dd>
</dl>
<div class="highlight"><pre><span></span><span class="nx">fun</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">thisArg</span><span class="p">[,</span> <span class="nx">arg1</span><span class="p">[,</span> <span class="nx">arg2</span><span class="p">[,</span> <span class="p">...]]])</span>
</pre></div>
<p>As you know that <cite>.then</cite> method tasks a callback with single argument. When the
previous promise is resolved, the result will be passed that single callback argument.
With this in mind if you check the method <cite>handler.handle</cite>, this function takes
two arguments and also works with its on <cite>this</cite> context. Here is where the <cite>bind</cite>
help us to partially fill the required arguments before hand and then use that
partially function with <cite>.then</cite> clause.</p>
<p>If you check the function arguments, we already expecting the <cite>result</cite>
argument. And the <cite>this</cite> object inside the <cite>handle</cite> function now resolved to
the actual <cite>HandleRequest</cite> object that we created.</p>
<div class="highlight"><pre><span></span><span class="nx">handle</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">header</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;this object: &#39;</span> <span class="o">+</span> <span class="k">typeof</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; result: &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">...</span>
</pre></div>
<p>We can bind <cite>this</cite> object as <cite>null</cite> if we want, so that the function work without
any external context with it.</p>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">handle</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">headers</span><span class="p">))</span>
</pre></div>
<p>If you want to see this behavior without promise chain, check bellow example for
pure use of bind.</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">wrappedHandler</span> <span class="o">=</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">handle</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">headers</span><span class="p">);</span>
    <span class="nx">wrappedHandler</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>
</pre></div>
<p>This is actually happening inside the promise. Here the <cite>wrappedHandler</cite> function is called as Bound function.</p>
<div class="section" id="take-away">
<h2>Take away</h2>
<ol class="arabic simple">
<li><cite>bind</cite> can be used to partially fill the arguments ( Term for this in functional programming is 'currying')</li>
<li>Can inject custom <cite>this</cite> context rather than the default global <cite>this</cite> or from current runtime context.</li>
<li>Really helpful with the <cite>Promise</cite> based programming and other cases via <cite>currying</cite>.</li>
</ol>
</div>
<div class="section" id="reference">
<h2>Reference</h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind</a></li>
</ol>
</div>

            <a href="#" class="go-top">Go Top</a>
    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "haridas"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
        </div>
    </div>
                    </div>

            </div>

            <div class="container-footer">
<footer class="footer">
                <a href="http://twitter.com/haridas_n"> Twitter</a> |
                <a href="http://github.com/haridas"> Github</a> |
                <a href="http://in.linkedin.com/pub/haridas-n/19/95/825"> Linkedin</a>
        &ndash;
        &copy; HN &ndash;
        <i> <a href="https://github.com/haridas/hn-theme">Built with HN Theme</a> </i>
        for <a href="https://blog.getpelican.com/">Pelican</a>
</footer>            </div>

    </div>

    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <!--
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "https://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-23592173-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>
    -->

    <script type="text/javascript">

      var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23592173-1']);
          _gaq.push(['_trackPageview']);

    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();

    </script>

</body>
</html>